<!DOCTYPE html>

<html lang="zh-CN">

<head>

    <meta charset="UTF-8">

    <title>èšä¼šç¿»ç‚¸å¼¹</title>

    <style>

        body {

            text-align: center;

            font-family: sans-serif;

        }

        #game-container {

            margin: 20px auto;

            display: inline-block;

        }

        .grid {

            display: grid;

            grid-template-columns: repeat(5, 60px);

            grid-gap: 5px;

            margin-bottom: 20px;

        }

        .cell {

            width: 60px;

            height: 60px;

            background-color: #3498db;

            border-radius: 5px;

            display: flex;

            align-items: center;

            justify-content: center;

            font-size: 24px;

            font-weight: bold;

            color: white;

            cursor: pointer;

            user-select: none;

        }

        .cell.revealed {

            background-color: #ecf0f1;

            color: #2c3e50;

            cursor: default;

        }

        .cell.bomb {

            background-color: #e74c3c;

        }

        #status {

            font-size: 20px;

            margin: 10px;

        }

        button {

            padding: 10px 20px;

            font-size: 16px;

            cursor: pointer;

        }

    </style>

</head>

<body>

    <h1>èšä¼šç¿»ç‚¸å¼¹ ğŸ’£</h1>

    <div id="game-container">

        <div id="status">æ¸¸æˆå¼€å§‹ï¼è½®æµç‚¹å‡»æ ¼å­ã€‚</div>

        <div class="grid" id="game-board">

            <!-- æ£‹ç›˜æ ¼å­å°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->

        </div>

        <button onclick="resetGame()">é‡æ–°å¼€å§‹æ¸¸æˆ</button>
        <!-- åœ¨ <button onclick="resetGame()">é‡æ–°å¼€å§‹æ¸¸æˆ</button> è¿™ä¸€è¡Œä¹‹åï¼Œæ·»åŠ ä»¥ä¸‹æŒ‰é’® -->
        <button onclick="openCustomizeModal()" style="margin-left: 10px; background-color: #9b59b6; color: white;">è‡ªå®šä¹‰é¢˜åº“</button>

        <!-- åœ¨ </div> å’Œ </body> ä¹‹å‰ï¼Œæ·»åŠ è¿™ä¸ªéšè—çš„å¼¹çª—ï¼ˆæ¨¡æ€æ¡†ï¼‰ç»“æ„ -->
        <div id="customModal" style="display: none; position: fixed; z-index: 100; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5);">
            <div style="background-color: white; margin: 10% auto; padding: 20px; border-radius: 10px; width: 80%; max-width: 600px;">
                <h2>è‡ªå®šä¹‰é¢˜åº“ ğŸ“</h2>
                <p>è¯·æŒ‰ç…§ä»¥ä¸‹æ ¼å¼è¾“å…¥é¢˜ç›®ï¼Œä¸€è¡Œä¸€ä¸ªï¼š</p>
                <p><strong>æ ¼å¼ï¼š</strong> <code>çœŸå¿ƒè¯:é—®é¢˜å†…å®¹</code> æˆ– <code>å¤§å†’é™©:æŒ‘æˆ˜å†…å®¹</code></p>
                <p><strong>ä¾‹å¦‚ï¼š</strong><br>
                    çœŸå¿ƒè¯:ä½ ä¸Šæ¬¡å“­æ˜¯ä»€ä¹ˆæ—¶å€™ï¼Ÿ<br>
                    å¤§å†’é™©:ç”¨æ‰‹æœºç»™é€šè®¯å½•é‡Œç¬¬ä¸‰ä¸ªäººå‘ä¸€å¥â€œæˆ‘æƒ³ä½ äº†â€ã€‚
                </p>
                <textarea id="questionInput" rows="15" style="width: 100%; margin: 15px 0; padding: 10px; font-family: monospace;"></textarea>
                <div>
                    <button onclick="saveCustomQuestions()" style="padding: 10px 20px; background-color: #2ecc71; color: white; border: none; border-radius: 5px; cursor: pointer;">ä¿å­˜å¹¶å…³é—­</button>
                    <button onclick="closeCustomizeModal()" style="padding: 10px 20px; margin-left: 10px; background-color: #95a5a6; color: white; border: none; border-radius: 5px; cursor: pointer;">å–æ¶ˆ</button>
                    <button onclick="resetToDefault()" style="padding: 10px 20px; margin-left: 10px; background-color: #e67e22; color: white; border: none; border-radius: 5px; cursor: pointer;">æ¢å¤é»˜è®¤é¢˜ç›®</button>
                </div>
            </div>
        </div>
    </div>

 

    <script>

        // =========== æ¸¸æˆé…ç½® ===========

        const GRID_SIZE = 5;   // 5x5çš„æ£‹ç›˜

        const BOMB_COUNT = 3;  // æ”¾ç½®3é¢—ç‚¸å¼¹

        let gameBoard = [];    // å­˜å‚¨æ£‹ç›˜æ•°æ®

        let gameOver = false;

 

        // =========== åˆå§‹åŒ–æ¸¸æˆ ===========

        function initGame() {

            document.getElementById('status').textContent = 'æ¸¸æˆå¼€å§‹ï¼è½®æµç‚¹å‡»æ ¼å­ã€‚';

            gameOver = false;

            gameBoard = [];

            const boardElement = document.getElementById('game-board');

            boardElement.innerHTML = ''; // æ¸…ç©ºæ£‹ç›˜

            boardElement.style.gridTemplateColumns = `repeat(${GRID_SIZE}, 60px)`;

 

            // 1. åˆ›å»ºç©ºçš„æ ¼å­æ•°æ®

            for (let i = 0; i < GRID_SIZE * GRID_SIZE; i++) {

                gameBoard.push({

                    isBomb: false,

                    isRevealed: false,

                    element: null

                });

            }

 

            // 2. éšæœºæ”¾ç½®ç‚¸å¼¹

            let bombsPlanted = 0;

            while (bombsPlanted < BOMB_COUNT) {

                const randomIndex = Math.floor(Math.random() * gameBoard.length);

                if (!gameBoard[randomIndex].isBomb) {

                    gameBoard[randomIndex].isBomb = true;

                    bombsPlanted++;

                }

            }

 

            // 3. åˆ›å»ºæ ¼å­å…ƒç´ å¹¶æ˜¾ç¤º

            for (let i = 0; i < gameBoard.length; i++) {

                const cellData = gameBoard[i];

                const cellElement = document.createElement('div');

                cellElement.className = 'cell';

                cellElement.textContent = ''; // åˆå§‹ä¸ºç©ºç™½

                cellElement.addEventListener('click', () => revealCell(i));

 

                cellData.element = cellElement; // å…³è”æ•°æ®å’Œå…ƒç´ 

                boardElement.appendChild(cellElement);

            }

        }

 

        // =========== ç¿»å¼€æ ¼å­ ===========

        function revealCell(index) {

            if (gameOver) return;

            const cell = gameBoard[index];

            if (cell.isRevealed) return; // å·²ç¿»å¼€çš„æ ¼å­ä¸èƒ½å†ç‚¹

 

            cell.isRevealed = true;

            cell.element.classList.add('revealed');

 

            if (cell.isBomb) {

                // è¸©åˆ°ç‚¸å¼¹ï¼

                cell.element.textContent = 'ğŸ’£';

                cell.element.classList.add('bomb');

                gameOver = true;

                document.getElementById('status').textContent = 'ğŸ’¥ è¸©åˆ°ç‚¸å¼¹ï¼æ¥å—æƒ©ç½šå§ï¼';

                // ï¼ï¼ï¼è¿™é‡Œæ˜¯å…³é”®ï¼šè§¦å‘æƒ©ç½šï¼ï¼ï¼

                triggerPunishment();

            } else {

                // å®‰å…¨æ ¼å­ï¼Œå¯ä»¥åœ¨è¿™é‡Œè®¡ç®—å¹¶æ˜¾ç¤ºå‘¨å›´ç‚¸å¼¹æ•°ï¼ˆä¼ ç»Ÿæ‰«é›·é€»è¾‘ï¼‰

                // ä¸ºäº†ç®€åŒ–ï¼Œæˆ‘ä»¬åªæ˜¾ç¤ºä¸€ä¸ªå¯¹å‹¾

                cell.element.textContent = 'âœ“';

                cell.element.style.color = '#27ae60';

            }

        }

 

        // =========== æƒ©ç½šè§¦å‘å‡½æ•° ===========

        function triggerPunishment() {

            // è¿™é‡Œæ˜¯è¿æ¥â€œçœŸå¿ƒè¯å¤§å†’é™©â€çš„å…³é”®ï¼

            // ä½ å¯ä»¥å…ˆç”¨ä¸€ä¸ªç®€å•çš„å¼¹çª—æ¨¡æ‹Ÿ

            const truths = [

                "ä½ æœ€è¿‘ä¸€æ¬¡è¯´è°æ˜¯ä»€ä¹ˆï¼Ÿ",

                "åœ¨åœºè°æœ€è®©ä½ æœ‰å¥½æ„Ÿï¼Ÿ",

                "è¯´ä¸€ä»¶è‡ªå·±æœ€å°´å°¬çš„ç³—äº‹ã€‚"

            ];

            const dares = [

                "ç”¨èƒ³è†Šå½“æ¡¨åšåˆ’èˆ¹åŠ¨ä½œ10ä¸‹ã€‚",

                "å’Œå·¦è¾¹çš„äººå¯¹è§†30ç§’ä¸å‡†ç¬‘ã€‚",

                "æ¨¡ä»¿ä¸€ç§åŠ¨ç‰©ç›´åˆ°æœ‰äººçŒœå‡ºæ¥ã€‚"

            ];

 

            // éšæœºé€‰æ‹©çœŸå¿ƒè¯æˆ–å¤§å†’é™©

            const isTruth = Math.random() > 0.5;

            const pool = isTruth ? truths : dares;

            const randomIndex = Math.floor(Math.random() * pool.length);

            const challenge = pool[randomIndex];

 

            // å¼¹çª—æ˜¾ç¤ºæƒ©ç½šå†…å®¹ï¼ˆå®é™…å¯ä»¥åšå¾—æ›´ç¾è§‚ï¼‰

            setTimeout(() => {

                alert(`æƒ©ç½šæ—¶é—´ï¼\n\n${isTruth ? 'ã€çœŸå¿ƒè¯ã€‘' : 'ã€å¤§å†’é™©ã€‘'}\n${challenge}`);

            }, 500); // å»¶è¿ŸåŠç§’ï¼Œè®©çˆ†ç‚¸æ•ˆæœå…ˆæ˜¾ç¤º

        }

 

        // =========== é‡ç½®æ¸¸æˆ ===========

        function resetGame() {

            initGame();

        }

 

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨å¼€å§‹æ¸¸æˆ

        window.onload = initGame;
        // =========== è‡ªå®šä¹‰é¢˜åº“åŠŸèƒ½ ===========
        // é»˜è®¤é¢˜åº“ï¼ˆå½“ç”¨æˆ·æ²¡æœ‰è‡ªå®šä¹‰æ—¶ä½¿ç”¨ï¼‰
        const defaultTruths = ["ä½ æœ€è¿‘ä¸€æ¬¡è¯´è°æ˜¯ä»€ä¹ˆï¼Ÿ", "åœ¨åœºè°æœ€è®©ä½ æœ‰å¥½æ„Ÿï¼Ÿ", "è¯´ä¸€ä»¶è‡ªå·±æœ€å°´å°¬çš„ç³—äº‹ã€‚"];
        const defaultDares = ["ç”¨èƒ³è†Šå½“æ¡¨åšåˆ’èˆ¹åŠ¨ä½œ10ä¸‹ã€‚", "å’Œå·¦è¾¹çš„äººå¯¹è§†30ç§’ä¸å‡†ç¬‘ã€‚", "æ¨¡ä»¿ä¸€ç§åŠ¨ç‰©ç›´åˆ°æœ‰äººçŒœå‡ºæ¥ã€‚"];

        // å½“å‰æ¸¸æˆä½¿ç”¨çš„é¢˜åº“ï¼ˆåˆå§‹ä¸ºé»˜è®¤é¢˜åº“ï¼‰
        let currentTruths = [...defaultTruths];
        let currentDares = [...defaultDares];

        // 1. æ‰“å¼€è‡ªå®šä¹‰å¼¹çª—
        function openCustomizeModal() {
            // å°è¯•ä»æµè§ˆå™¨æœ¬åœ°å­˜å‚¨ä¸­è¯»å–å·²ä¿å­˜çš„è‡ªå®šä¹‰é¢˜ç›®
            const savedText = localStorage.getItem('customBombGameQuestions');
            const textarea = document.getElementById('questionInput');
            
            if (savedText) {
                textarea.value = savedText; // å¦‚æœæœ‰ä¿å­˜çš„ï¼Œå°±æ˜¾ç¤ºå‡ºæ¥
            } else {
                // å¦åˆ™ï¼ŒæŠŠå½“å‰é¢˜åº“æŒ‰æ ¼å¼ç”Ÿæˆæ–‡æœ¬æ˜¾ç¤º
                const lines = [];
                currentTruths.forEach(q => lines.push(`çœŸå¿ƒè¯:${q}`));
                currentDares.forEach(q => lines.push(`å¤§å†’é™©:${q}`));
                textarea.value = lines.join('\n');
            }
            
            document.getElementById('customModal').style.display = 'block';
        }

        // 2. å…³é—­è‡ªå®šä¹‰å¼¹çª—
        function closeCustomizeModal() {
            document.getElementById('customModal').style.display = 'none';
        }

        // 3. ä¿å­˜è‡ªå®šä¹‰é¢˜ç›®
        function saveCustomQuestions() {
            const inputText = document.getElementById('questionInput').value.trim();
            const newTruths = [];
            const newDares = [];

            // è§£æç”¨æˆ·è¾“å…¥çš„æ–‡æœ¬
            const lines = inputText.split('\n');
            for (let line of lines) {
                line = line.trim();
                if (!line) continue; // è·³è¿‡ç©ºè¡Œ

                if (line.startsWith('çœŸå¿ƒè¯:')) {
                    newTruths.push(line.substring(4).trim()); // å»æ‰â€œçœŸå¿ƒè¯:â€å››ä¸ªå­—
                } else if (line.startsWith('å¤§å†’é™©:')) {
                    newDares.push(line.substring(4).trim()); // å»æ‰â€œå¤§å†’é™©:â€å››ä¸ªå­—
                } else {
                    // å¦‚æœè¡Œé¦–æ²¡æœ‰å‰ç¼€ï¼Œé»˜è®¤å½“ä½œçœŸå¿ƒè¯ï¼ˆæˆ–å¯ä»¥å¿½ç•¥ï¼Œè¿™é‡ŒæŒ‰çœŸå¿ƒè¯å¤„ç†ï¼‰
                    newTruths.push(line);
                }
            }

            // æ›´æ–°å½“å‰é¢˜åº“ï¼ˆå¦‚æœç”¨æˆ·æ¸…ç©ºäº†ï¼Œåˆ™ä½¿ç”¨é»˜è®¤é¢˜åº“ï¼‰
            currentTruths = newTruths.length > 0 ? newTruths : [...defaultTruths];
            currentDares = newDares.length > 0 ? newDares : [...defaultDares];

            // å°†ç”¨æˆ·è¾“å…¥çš„åŸå§‹æ–‡æœ¬ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨ï¼Œä»¥ä¾¿ä¸‹æ¬¡ç¼–è¾‘
            localStorage.setItem('customBombGameQuestions', inputText);
            
            alert(`é¢˜åº“å·²æ›´æ–°ï¼\næˆåŠŸåŠ è½½ ${currentTruths.length} ä¸ªçœŸå¿ƒè¯ï¼Œ${currentDares.length} ä¸ªå¤§å†’é™©ã€‚`);
            closeCustomizeModal();
        }

        // 4. æ¢å¤é»˜è®¤é¢˜ç›®
        function resetToDefault() {
            if (confirm('ç¡®å®šè¦æ¢å¤ä¸ºé»˜è®¤é¢˜ç›®å—ï¼Ÿè¿™ä¼šæ¸…é™¤ä½ å·²ä¿å­˜çš„è‡ªå®šä¹‰é¢˜ç›®ã€‚')) {
                currentTruths = [...defaultTruths];
                currentDares = [...defaultDares];
                localStorage.removeItem('customBombGameQuestions'); // æ¸…é™¤ä¿å­˜çš„è®°å½•
                document.getElementById('questionInput').value = ''; // æ¸…ç©ºè¾“å…¥æ¡†
                alert('å·²æ¢å¤é»˜è®¤é¢˜ç›®ï¼');
            }
        }

        // 5. ä¿®æ”¹åŸæ¥çš„æƒ©ç½šè§¦å‘å‡½æ•°ï¼Œä½¿å…¶ä½¿ç”¨â€œå½“å‰é¢˜åº“â€
        function triggerPunishment() {
            // éšæœºé€‰æ‹©çœŸå¿ƒè¯æˆ–å¤§å†’é™©
            const isTruth = Math.random() > 0.5;
            const pool = isTruth ? currentTruths : currentDares;

            // é˜²æ­¢é¢˜åº“ä¸ºç©ºçš„æƒ…å†µ
            if (pool.length === 0) {
                pool.push(isTruth ? 'ï¼ˆè¯·å…ˆè‡ªå®šä¹‰çœŸå¿ƒè¯é¢˜ç›®ï¼‰' : 'ï¼ˆè¯·å…ˆè‡ªå®šä¹‰å¤§å†’é™©é¢˜ç›®ï¼‰');
            }

            const randomIndex = Math.floor(Math.random() * pool.length);
            const challenge = pool[randomIndex];

            // å¼¹çª—æ˜¾ç¤ºæƒ©ç½šå†…å®¹
            setTimeout(() => {
                alert(`æƒ©ç½šæ—¶é—´ï¼\n\n${isTruth ? 'ã€çœŸå¿ƒè¯ã€‘' : 'ã€å¤§å†’é™©ã€‘'}\n${challenge}`);
            }, 500);
        }
    </script>

</body>

</html>